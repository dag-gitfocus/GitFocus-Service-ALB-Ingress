pipeline {
  environment {
    registry = "gitfocusimages/gitfocus"
    registryCredential = 'dockerhub'
    dockerImage = ''
  }
  agent any
  tools { 
    maven 'maven 3.6.3' 
  }	
  /*
  agent {
    docker {
    image "maven:3.6.0-jdk-13"
    args "-v /tmp/maven:/root/.m2"
    }
  }
  */
  stages {
    stage ("Building Jar") {
      steps {
	    sh "mvn -Dmaven.test.skip=true clean install" 
      }  
    }  
   }
   stage ("Code Analysis") {
      steps {
	    withSonarQubeEnv('SonarQube') {
	         sh "mvn sonar:sonar -Dsonar.projectKey="GitFocus-Service" 
	    }
      }	   
    }
}
